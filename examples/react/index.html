<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>React Widget - Host (Shadow DOM)</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 12px; }
      .host { border: 1px dashed #ccc; padding: 8px; margin: 8px 0; }
      h2 { margin: 12px 0 4px; }
      code { background: #f3f4f6; padding: 2px 4px; border-radius: 4px; }
    </style>
  </head>
  <body>
    <h2>React host page (served by Vite)</h2>
    <div id="react-hosts"></div>

    <script type="module">
      class SimpleGreeter extends HTMLElement {
        constructor() {
          super();
          this.attachShadow({ mode: 'open' });
        }
        async connectedCallback() {
          try {
            const mod = await import('/src/start.tsx');
            debugger
            if (typeof mod.start === 'function') {
              mod.start(this.shadowRoot);
            } else {
              console.error('Module does not export start(shadowRoot)');
            }
          } catch (err) {
            console.error('Failed to import React widget', err);
          }
        }
      }
      customElements.define('simple-greeter', SimpleGreeter);

      const root = document.getElementById('react-hosts');
      for (let i = 1; i <= 2; i++) {
        const h2 = document.createElement('h2');
        h2.textContent = `React Widget ${i}`;
        const host = document.createElement('div');
        host.className = 'host';
        const el = document.createElement('simple-greeter');
        const info = document.createElement('div');
        info.innerHTML = `Source: <code>/src/start.tsx</code>`;
        host.appendChild(el);
        host.appendChild(info);
        root.appendChild(h2);
        root.appendChild(host);
      }
    </script>
  </body>
  </html>


